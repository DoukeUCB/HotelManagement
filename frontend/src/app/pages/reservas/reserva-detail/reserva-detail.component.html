<a routerLink="/reservas" class="link-back">← Volver</a>
<h1>Detalle de reserva</h1>

<!-- Estado de carga -->
<div *ngIf="loading()">Cargando...</div>

<!-- Error -->
<div *ngIf="!loading() && error()" class="error">{{ error() }}</div>

<!-- Contenido cuando ya no está cargando -->
<section *ngIf="!loading()">

  <!-- Cabecera basada en el primer detalle -->
  <ng-container *ngIf="header() as h; else sinHeader">
    <div class="card">
      <div class="row">
        <div>
          <h3>Reserva: {{ h.reservaId }}</h3>
          <div class="muted">
            Huésped: <strong>{{ h.nombreHuesped }}</strong> ·
            Cant. huéspedes: {{ h.cantidadHuespedes }}
          </div>
        </div>
        <div class="status">Hab. {{ h.numeroHabitacion }}</div>
      </div>

      <div class="grid">
        <div>
          <label>Entrada</label>
          <div>{{ h.fechaEntrada | date:'dd/MM/yyyy' }}</div>
        </div>
        <div>
          <label>Salida</label>
          <div>{{ h.fechaSalida | date:'dd/MM/yyyy' }}</div>
        </div>
        <div class="right">
          <label>Total</label>
          <div class="total">{{ total() | number:'1.2-2' }}</div>
        </div>
      </div>
    </div>

    <h2>Ítems</h2>
    <div class="table" *ngIf="detalles().length; else noItems">
      <div class="thead">
        <div>Hab.</div>
        <div>Huésped</div>
        <div>Entrada</div>
        <div>Salida</div>
        <div class="right">Precio Total</div>
      </div>

      <div class="row" *ngFor="let d of detalles()">
        <div>{{ d.numeroHabitacion }}</div>
        <div>{{ d.nombreHuesped }}</div>
        <div>{{ d.fechaEntrada | date:'dd/MM/yyyy' }}</div>
        <div>{{ d.fechaSalida  | date:'dd/MM/yyyy' }}</div>
        <div class="right">{{ d.precioTotal | number:'1.2-2' }}</div>
      </div>
    </div>
    <ng-template #noItems>
      <div class="empty">No hay detalles para esta reserva.</div>
    </ng-template>
  </ng-container>

  <ng-template #sinHeader>
    <div class="empty">No se encontró información para esta reserva.</div>
  </ng-template>
</section>
